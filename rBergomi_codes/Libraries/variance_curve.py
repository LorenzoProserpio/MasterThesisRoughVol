import numpy as np

Z1 = np.array([0.23934445564954748, 0.2370172145384514, 0.23319383855246545, 0.22779527372712297, 0.22410506177795986, 0.22796530521676028, 0.22992033119402192, 0.23360387896928214, 0.23923251959598327])
Z2 = np.array([0.2355916740288041, 0.23547872334450043, 0.2278527332290963, 0.2493545607795239, 0.2684664268847795, 0.16758709131144714, 0.23526774429356268, 0.16354991037070024, 0.09001896821824877])
Z3 = np.array([2.3126258447474375, 2.077549483492911, 2.1200577204482105, 2.637109433927137, 2.9677374658205307, 2.385086643216494, 3.064763505035709, 2.3367542064926443, 2.114562825304444])

# Compute the initial forward variance curve at a given time t
# using the Gompertz function with precomputed parameters
    
def variance_curve(t, index = 0):
    z1 = Z1[index]; z2 = Z2[index]; z3 = Z3[index];
    return (z1 * np.exp(-z2 * np.exp(-z3 * t)))**2 + 2*t*z1**2*z2*z3*np.exp(-2*z2*np.exp(-z3*t)-z3*t)